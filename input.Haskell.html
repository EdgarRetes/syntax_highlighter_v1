<!DOCTYPE html>
<html>
<head><title>Tokenized Code - Haskell</title></head>
<body><pre><code>
module Main where

import System.IO
import Data.Char (isAlpha, toUpper)

-- Función para obtener las letras de un nombre (sin espacios)
obtenerLetras :: String -> [Char]
obtenerLetras = filter (/= ' ')

-- Función para validar si el nombre es válido (solo letras y espacios)
esNombreValido :: String -> Bool
esNombreValido nombre = all (\c -> isAlpha c || c == ' ') nombre && not (null nombre)

-- Función para convertir a mayúsculas todas las letras de un nombre
convertirMayusculas :: String -> String
convertirMayusculas = map toUpper

-- Función para calcular los años que faltan para ser mayor de edad
aniosParaMayor :: Int -> Int -> Int
aniosParaMayor edad minEdad
    | edad >= minEdad = 0
    | otherwise = minEdad - edad

-- Función para imprimir las letras del nombre con índice
imprimirLetrasConIndice :: String -> IO ()
imprimirLetrasConIndice nombre = mapM_ imprimirLetra (zip [1..] (obtenerLetras nombre))
  where
    imprimirLetra (i, c) = putStrLn $ show i ++ ". " ++ [c]

-- Función principal
main :: IO ()
main = do
    putStr "Por favor, ingresa tu nombre: "
    hFlush stdout
    nombreUsuario <- getLine

    if not (esNombreValido nombreUsuario)
        then putStrLn "Nombre inválido. Usa solo letras y espacios."
        else do
            putStrLn $ "\n¡Hola, " ++ convertirMayusculas nombreUsuario ++ "!"
            putStrLn "Las letras de tu nombre son:"
            imprimirLetrasConIndice nombreUsuario

            putStr "¿Cuántos años tienes?: "
            hFlush stdout
            edadStr <- getLine

            let edad = read edadStr :: Int
                minEdad = 18

            if edad >= minEdad
                then putStrLn "¡Eres mayor de edad!"
                else putStrLn $ "Te faltan " ++ show (aniosParaMayor edad minEdad) ++ " años para ser mayor de edad."

            putStrLn "\n¡Programa terminado!"

</code></pre></body>
</html>